54012 – No "pageContext" in tag files' generated java code when using code generation by JSTL tagplugin "Set"
Created attachment 29485 [details]
Patch for org.apache.jasper.tagplugins.jstl.core.Set.java
The code generated by the following code from " org.apache.jasper.tagplugins.jstl.core.Set" can't work in Tag Files.
There is no "PageContext" in tag file.
So this should check "isTagFile".
String strVar = ctxt.getConstantAttribute("var");
ctxt.generateJavaSource("if(null != " + resultName + "){");
ctxt.generateJavaSource("    pageContext.setAttribute(\"" + strVar + "\"," + resultName + "," + iScope + ");");
ctxt.generateJavaSource("} else {");
if(hasScope){
ctxt.generateJavaSource("    pageContext.removeAttribute(\"" + strVar + "\"," + iScope + ");");
}else{
ctxt.generateJavaSource("    pageContext.removeAttribute(\"" + strVar + "\");");
}
ctxt.generateJavaSource("}");