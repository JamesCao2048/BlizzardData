Bug 204651 AssertionError for an image (byte[]) in a scripted data set column of type "any
For the display of an image created dynamically by an own java class I use a scripted data set with one column of type "any" and a ScriptedDataSetEventAdapter that sets the column value with a byte[]. This was described in a BIRT example and works with BIRT 2.1.2. Now, we are using BIRT 2.2 and we get an AssertionError running our report creation JUnit test (where the assertion check is enabled). It seems that the constructor of the "ResultObject" class has got a new if-statement if the result field is of type "any". The assertion within the invoked method "ResultFieldMetadata.setDataType()" checks whether the data type is an Integer.class or a Double.class or ... As byte[] isn't part of the expected java data types the assertion error is thrown (see below). java.lang.AssertionError at org.eclipse.birt.data.engine.executor.ResultFieldMetadata.setDataType(Result FieldMetadata.java:100) at org.eclipse.birt.data.engine.executor.ResultObject.<init>(ResultObject.java: 55) at org.eclipse.bir
t.data.engine.executor.cache.ExpandableRowResultSet.next(Expa ndableRowResultSet.java:77) at org.eclipse.birt.data.engine.executor.cache.SmartCacheHelper.populateData(Sm artCacheHelper.java:268) at org.eclipse.birt.data.engine.executor.cache.SmartCacheHelper.initInstance(Sm artCacheHelper.java:241) at org.eclipse.birt.data.engine.executor.cache.SmartCacheHelper.getResultSetCac he(SmartCacheHelper.java:204) at org.eclipse.birt.data.engine.executor.cache.SmartCache.<init>(SmartCache.jav a:68) at org.eclipse.birt.data.engine.executor.transform.pass.PassUtil.populateOdiRes ultSet(PassUtil.java:113) at org.eclipse.birt.data.engine.executor.transform.pass.PassUtil.pass(PassUtil. java:66) at org.eclipse.birt.data.engine.executor.transform.pass.PassManager.doSinglePas s(PassManager.java:185) at org.eclipse.birt.data.engine.executor.transform.pass.PassManager.pass(PassMa nager.java:90) at org.eclipse.birt.data.engine.executor.transform.pass.PassManager.populateRes ultSet(PassManager.java:72) at
org.eclipse.birt.data.engine.executor.transform.ResultSetPopulator.populateR esultSet(ResultSetPopulator.java:208) at org.eclipse.birt.data.engine.executor.transform.CachedResultSet.<init>(Cache dResultSet.java:132) at org.eclipse.birt.data.engine.executor.CandidateQuery.execute(CandidateQuery. java:106) at org.eclipse.birt.data.engine.impl.PreparedScriptDSQuery$ScriptDSQueryExecuto r.executeOdiQuery(PreparedScriptDSQuery.java:223) at org.eclipse.birt.data.engine.impl.QueryExecutor.execute(QueryExecutor.java:7 61) at org.eclipse.birt.data.engine.impl.ServiceForQueryResults.executeQuery(Servic eForQueryResults.java:216) at org.eclipse.birt.data.engine.impl.QueryResults.getResultIterator(QueryResult s.java:152) at org.eclipse.birt.report.engine.data.dte.QueryResultSet.<init>(QueryResultSet .java:83) at org.eclipse.birt.report.engine.data.dte.DteDataEngine.doExecuteQuery(DteData Engine.java:155) at org.eclipse.birt.report.engine.data.dte.DteDataEngine.doExecuteQuery(DteData Engine.java