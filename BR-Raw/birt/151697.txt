Bug 151697 PDF Render performance enhancement
When trying to find out why our reports were taking so long to render to pdf (itext) we found out that a simple fix would allow them to run 5 to 6 times faster.
Using TPTP we found out that a significant part of the time spent in the rendering process was at the constructor of org.eclipse.birt.report.engine.layout.area.impl.TextArea That constructor runs several initialization methods of the owned Style instance, using a constant as parameter style.setXXXX(CSSConstants.CSS_NONE_VALUE).
Each of this methods of org.eclipse.birt.report.engine.css.dom.AbstractStyle invoke a method setCssText(int index,String cssText ) that will go througth a process of parsing , etc .
This can be changed at the begining of the method checking it the input parameter is CSSConstants.CSS_NONE_VALUE, and if true just return CSSValueConstants.NUMBER_0.public void setCssText( int index, String cssText ) { //begin fix if (CSSConstants.CSS_NONE_VALUE.equals(cssText)) { setProperty( index,CSSValueConstants.NUMBER_0); return; } //end fix if ( cssText != null ) { ......
Something similiar can be done at the begining of method parsePropertyValue(int idx, String value) from the the class CSSValue public CSSValue parsePropertyValue(int idx, String value) { //begin fix if (CSSConstants.CSS_NONE_VALUE.equals(value)) return CSSValueConstants.NUMBER_0; //end fix assert idx >= 0 && idx
< pm.getNumberOfProperties(); ......
This change of the code we come from 20 minutes to 3:15 on a ~1200 pages pdf.
A similiar improvement as noticed much smaller reports.
As this is a so simple change and didn't attached the code.
Thanks Joao